<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flowchart Website - PortalHC_KPB</title>

    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        body {
            background-color: #f8f9fa;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        .page-container {
            max-width: 210mm;
            /* A4 width approx */
            margin: 40px auto;
            background: white;
            padding: 40px;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.1);
            border-radius: 8px;
        }

        .mermaid {
            display: flex;
            justify-content: center;
            margin: 20px 0;
            background-color: white;
        }

        h1,
        h2,
        h3 {
            color: #2c3e50;
            margin-top: 1.5em;
        }

        h1 {
            border-bottom: 2px solid #eaecef;
            padding-bottom: 0.3em;
            margin-top: 0;
        }

        h2 {
            border-bottom: 1px solid #eaecef;
            padding-bottom: 0.3em;
        }

        code {
            background-color: #f6f8fa;
            padding: 0.2em 0.4em;
            border-radius: 3px;
            color: #e83e8c;
        }

        pre {
            background-color: #f6f8fa;
            padding: 16px;
            border-radius: 6px;
            overflow: auto;
        }

        blockquote {
            border-left: 4px solid #dfe2e5;
            padding-left: 1em;
            color: #6a737d;
        }

        table {
            width: 100%;
            margin-bottom: 1rem;
            color: #212529;
            border-collapse: collapse;
        }

        th,
        td {
            padding: 0.75rem;
            vertical-align: top;
            border-top: 1px solid #dee2e6;
        }

        thead th {
            vertical-align: bottom;
            border-bottom: 2px solid #dee2e6;
            background-color: #f8f9fa;
        }

        @media print {
            body {
                background-color: white;
            }

            .page-container {
                box-shadow: none;
                margin: 0;
                padding: 0;
                width: 100%;
                max-width: 100%;
            }

            .no-print {
                display: none !important;
            }

            a {
                text-decoration: none;
                color: black;
            }
        }
    </style>
</head>

<body>

    <!-- Print Instruction Header -->
    <div class="container mt-3 no-print">
        <div class="alert alert-info d-flex align-items-center shadow-sm">
            <i class="fas fa-print fa-2x me-3"></i>
            <div>
                <h5 class="alert-heading fw-bold mb-1">Cara Simpan ke PDF</h5>
                <p class="mb-0">Tekan <kbd>Ctrl + P</kbd> atau klik kanan pilih <b>Print</b>, lalu pilih <b>"Save as
                        PDF"</b> pada pilihan printer.</p>
            </div>
            <button onclick="window.print()" class="btn btn-primary ms-auto fw-bold"><i
                    class="fas fa-file-pdf me-2"></i>Print to PDF</button>
        </div>
    </div>

    <!-- Main Content -->
    <div class="page-container" id="content">
        <!-- Markdown content will be rendered here -->
        <div class="text-center py-5">
            <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden">Loading...</span>
            </div>
            <p class="mt-2 text-muted">Rendering Flowcharts...</p>
        </div>
    </div>

    <!-- Raw Markdown Data -->
    <textarea id="markdown-source" style="display:none;">
# PortalHC_KPB - Flowchart Lengkap Website

## üèóÔ∏è Arsitektur Sistem

```mermaid
graph TB
    subgraph TECH["Technology Stack"]
        ASPNET["ASP.NET Core MVC"]
        IDENTITY["ASP.NET Core Identity"]
        SQLITE["SQLite Database"]
        BOOTSTRAP["Bootstrap 5.3"]
    end
    
    subgraph RBAC["6-Level RBAC System"]
        L1["Level 1: Admin"]
        L2["Level 2: HC"]
        L3["Level 3: Direktur/VP/Manager"]
        L4["Level 4: Section Head/Sr Supervisor"]
        L5["Level 5: Coach"]
        L6["Level 6: Coachee"]
    end
    
    L1 --> L2 --> L3 --> L4 --> L5 --> L6
```

---

## üîê Flow Autentikasi (Login/Logout)

```mermaid
flowchart TD
    START([User Mengakses Website]) --> CHECK{Sudah Login?}
    
    CHECK -->|Ya| HOME[Home Page]
    CHECK -->|Tidak| LOGIN[Halaman Login]
    
    LOGIN --> INPUT[Masukkan Email & Password]
    INPUT --> VALIDATE{Validasi Kredensial}
    
    VALIDATE -->|Gagal| ERROR[Tampilkan Error Message]
    ERROR --> LOGIN
    
    VALIDATE -->|Berhasil| SESSION[Buat Session User]
    SESSION --> ROLE[Load User Role & Level]
    ROLE --> HOME
    
    HOME --> LOGOUT{Logout?}
    LOGOUT -->|Ya| CLEAR[Clear Session]
    CLEAR --> LOGIN
    LOGOUT -->|Tidak| NAVIGATE[Navigasi ke Modul]
```

---

## üó∫Ô∏è Struktur Navigasi Utama

```mermaid
flowchart TB
    HOME["üè† Home Page"]
    
    subgraph CMP["üìã Competency Management Platform"]
        CMP_KKJ["Susunan KKJ<br/>(Matrix View)"]
        CMP_ASSESS["Assessment"]
        CMP_RECORDS["Capability Records"]
        CMP_MAP["KKJ-IDP Mapping"]
    end
    
    subgraph CDP["üìà Competency Development Platform"]
        CDP_IDP["Plan IDP (Silabus)"]
        CDP_COACHING["Laporan Coaching"]
        CDP_PROGRESS["Progress & Tracking"]
        CDP_DASH["Dashboard Monitoring"]
    end
    
    subgraph BP["üë§ Business Partner Platform"]
        BP_TALENT["Talent Profile & Career"]
        BP_POINT["Point System Program"]
        BP_ELIGIBILITY["Eligibility Validator"]
    end
    
    subgraph ACCOUNT["‚öôÔ∏è Account"]
        ACC_PROFILE["My Profile"]
        ACC_SETTINGS["Settings"]
        ACC_LOGOUT["Logout"]
    end
    
    HOME --> CMP
    HOME --> CDP
    HOME --> BP
    HOME --> ACCOUNT
```

---

## üìã Modul 1: CMP (Competency Management Platform)

### 1.1 Susunan KKJ - Flow berdasarkan Role

```mermaid
flowchart TD
    KKJ_START([User Akses KKJ]) --> CHECK_LEVEL{User Level?}
    
    CHECK_LEVEL -->|Level 1-3<br/>Admin/HC/Management| SEC_SELECT[Halaman Pilih Section]
    CHECK_LEVEL -->|Level 4-6<br/>Section Head ke bawah| DIRECT[Langsung ke Matrix View]
    
    SEC_SELECT --> PICK{Pilih Section}
    PICK --> GAST[GAST]
    PICK --> RFCC[RFCC]
    PICK --> DHT[DHT/HMU]
    PICK --> NGP[NGP]
    
    GAST --> MATRIX
    RFCC --> MATRIX
    DHT --> MATRIX
    NGP --> MATRIX
    DIRECT --> MATRIX
    
    MATRIX["Matrix KKJ Display"]
    MATRIX --> VIEW[Tampilkan 17 Kompetensi<br/>dengan Target Level per Jabatan]
    
    VIEW --> LEGEND["Legend:<br/>Level 1: Basic<br/>Level 2: Intermediate<br/>Level 3: Advanced"]
```

### 1.2 Assessment Flow

```mermaid
flowchart TD
    ASSESS_START([User Akses Assessment]) --> LOAD[Load Daftar Assessment]
    
    LOAD --> CATEGORIES{Kategori Assessment}
    
    CATEGORIES --> OJT["OJT<br/>(On Job Training)"]
    CATEGORIES --> IHT["IHT<br/>(Internal House Training)"]
    CATEGORIES --> LICENCOR["Training Licencor"]
    CATEGORIES --> OTS["OTS Simulation"]
    CATEGORIES --> HSSE["Mandatory HSSE Training"]
    CATEGORIES --> PROTON["PROTON Simulation"]
    
    OJT --> STATUS{Status Assessment}
    IHT --> STATUS
    LICENCOR --> STATUS
    OTS --> STATUS
    HSSE --> STATUS
    PROTON --> STATUS
    
    STATUS -->|Open| ACTION_OPEN["Mulai/Lanjut Assessment"]
    STATUS -->|Upcoming| ACTION_UPCOMING["Tampilkan Jadwal"]
    STATUS -->|Completed| ACTION_COMPLETED["Lihat Score & Certificate"]
```

### 1.3 Capability Records - Flow berdasarkan Role

```mermaid
flowchart TD
    REC_START([User Akses Records]) --> CHECK{User Level?}
    
    CHECK -->|Level 5-6<br/>Coach/Coachee| PERSONAL[Personal Training Records]
    CHECK -->|Level 1-4<br/>Admin-Sr Supervisor| SUPERVISOR[Supervisor View]
    
    PERSONAL --> MY_LIST["Daftar Training Pribadi:<br/>- Proton, OTS, OJT, IHT<br/>- MANDATORY HSSE<br/>- Training Licencor<br/>- ISS, OSS"]
    
    SUPERVISOR --> FILTER_UI["Form Filter:<br/>- Bagian<br/>- Kategori Training<br/>- Cari Nama/NIP<br/>- Status"]
    
    FILTER_UI --> APPLY[Apply Filter]
    APPLY --> WORKER_LIST["Daftar Pekerja"]
    
    WORKER_LIST --> COLUMNS["Kolom:<br/>Nama, NIP, Posisi,<br/>Selesai, Pending,<br/>Expiring, Progress, Action"]
    
    COLUMNS --> DETAIL[View Detail]
    DETAIL --> WORKER_DETAIL["Halaman Detail Pekerja<br/>dengan Filter & Search"]
```

### 1.4 KKJ-IDP Mapping

```mermaid
flowchart TD
    MAP_START([User Akses Mapping]) --> LOAD[Load CPDP Data]
    
    LOAD --> KOMPTENSI["5 Kompetensi Utama"]
    
    KOMPTENSI --> K1["1. Safe Work Practice & Lifesaving Rules"]
    KOMPTENSI --> K2["2. Energy Management"]
    KOMPTENSI --> K3["3. Catalyst & Chemical Management"]
    KOMPTENSI --> K4["4. Process Control & Computer Operations"]
    KOMPTENSI --> K5["5. Refinery/Oil Processing Operations"]
    
    K1 --> DETAIL_VIEW["Detail View:<br/>- Indikator Perilaku<br/>- Silabus<br/>- Target Deliverable"]
```

---

## üìà Modul 2: CDP (Competency Development Platform)

### 2.1 Plan IDP (Silabus)

```mermaid
flowchart TD
    IDP_START([User Akses IDP]) --> CHECK_ROLE{User Role?}
    
    CHECK_ROLE -->|HC| HC_FLOW["Section Selection First"]
    CHECK_ROLE -->|Section Head/Sr Supervisor| FILTER_FLOW["Cascading Filter:<br/>Bagian ‚Üí Unit ‚Üí Level"]
    CHECK_ROLE -->|Coach/Coachee| PERSONAL_IDP["Personal IDP View"]
    
    HC_FLOW --> SELECT_SEC[Pilih Section]
    SELECT_SEC --> PDF_VIEW
    
    FILTER_FLOW --> BAGIAN["Pilih Bagian"]
    BAGIAN --> UNIT["Pilih Unit"]
    UNIT --> LEVEL["Pilih Level"]
    LEVEL --> PDF_VIEW
    
    PDF_VIEW["Tampilkan PDF Silabus"]
    
    PERSONAL_IDP --> MY_IDP["Daftar IDP Pribadi"]
```

### 2.2 Laporan Coaching

```mermaid
flowchart TD
    COACH_START([User Akses Coaching]) --> LOAD[Load Coaching Data]
    
    LOAD --> VIEW_MODE{Mode Tampilan}
    
    VIEW_MODE --> COACH_VIEW["Coach View:<br/>Daftar Coachee"]
    VIEW_MODE --> COACHEE_VIEW["Coachee View:<br/>Daftar Coaching Session"]
    
    COACH_VIEW --> SESSION_LIST["Daftar Session Coaching"]
    COACHEE_VIEW --> SESSION_LIST
    
    SESSION_LIST --> DETAIL["Detail Session:<br/>- Tanggal<br/>- Topik<br/>- Feedback<br/>- Progress"]
```

### 2.3 Progress & Tracking

```mermaid
flowchart TD
    PROG_START([User Akses Progress]) --> LOAD[Load Progress Data]
    
    LOAD --> ITEMS["Progress Items:<br/>- IDP Progress<br/>- Training Status<br/>- Assessment Results"]
    
    ITEMS --> TRACK["Tracking View:<br/>- Overall Progress %<br/>- Completed Items<br/>- Pending Items<br/>- Expiring Soon"]
    
    TRACK --> ACTIONS{Role-Based Actions}
    
    ACTIONS -->|Supervisor| MANAGE["Manage Team Progress"]
    ACTIONS -->|Coachee| SELF["Self Progress View"]
```

### 2.4 Dashboard Monitoring

```mermaid
flowchart TD
    DASH_START([User Akses Dashboard]) --> LOAD[Load Dashboard Data]
    
    LOAD --> WIDGETS["Dashboard Widgets"]
    
    WIDGETS --> STAT1["Training Completion Rate"]
    WIDGETS --> STAT2["Assessment Scores Overview"]
    WIDGETS --> STAT3["Expiring Certifications"]
    WIDGETS --> STAT4["Team Progress Summary"]
    
    STAT1 --> CHARTS["Visual Charts & Graphs"]
    STAT2 --> CHARTS
    STAT3 --> CHARTS
    STAT4 --> CHARTS
```

---

## üë§ Modul 3: BP (Business Partner Platform)

### 3.1 Talent Profile & Career Historical

```mermaid
flowchart TD
    TALENT_START([User Akses Talent Profile]) --> LOAD[Load Profile Data]
    
    LOAD --> PROFILE["Profile Information:<br/>- Nama, NIO, Position<br/>- Unit, Directorate<br/>- Age, Tenure<br/>- Talent Classification"]
    
    PROFILE --> HISTORY["Career History"]
    HISTORY --> TIMELINE["Timeline View:<br/>- Tahun<br/>- Jabatan<br/>- Unit<br/>- Tipe (Promosi/Mutasi)<br/>- No SK<br/>- Keterangan"]
    
    PROFILE --> PERFORMANCE["Performance History"]
    PERFORMANCE --> GRADES["Performance Grades:<br/>A, B+, B, etc."]
```

### 3.2 Point System Program

```mermaid
flowchart TD
    POINT_START([User Akses Point System]) --> LOAD[Load Point Data]
    
    LOAD --> SUMMARY["Point Summary:<br/>- Total Points<br/>- Current Level<br/>- Next Level Threshold"]
    
    SUMMARY --> ACTIVITIES["Point Activities"]
    
    ACTIVITIES --> ACT1["Project Leadership"]
    ACTIVITIES --> ACT2["Internal Instructor"]
    ACTIVITIES --> ACT3["Innovation Award"]
    ACTIVITIES --> ACT4["Full Attendance"]
    
    ACT1 --> STATUS{Status}
    ACT2 --> STATUS
    ACT3 --> STATUS
    ACT4 --> STATUS
    
    STATUS -->|Verified| COUNTED["Points Counted"]
    STATUS -->|Pending| WAITING["Waiting Verification"]
```

### 3.3 Eligibility Validator

```mermaid
flowchart TD
    ELIG_START([User Akses Eligibility]) --> LOAD[Load Eligibility Data]
    
    LOAD --> INFO["Position Info:<br/>- Current Position<br/>- Target Position<br/>- Overall Status"]
    
    INFO --> CRITERIA["Eligibility Criteria"]
    
    CRITERIA --> C1["Tenure in Current Position"]
    CRITERIA --> C2["Performance Rating"]
    CRITERIA --> C3["Assessment Score"]
    CRITERIA --> C4["English Score (TOEIC)"]
    CRITERIA --> C5["Leadership Training"]
    
    C1 --> CHECK{Criteria Met?}
    C2 --> CHECK
    C3 --> CHECK
    C4 --> CHECK
    C5 --> CHECK
    
    CHECK -->|Ya| PASS["‚úÖ Eligible"]
    CHECK -->|Tidak| FAIL["‚ùå Not Eligible"]
    
    PASS --> RESULT["Overall Result"]
    FAIL --> RESULT
```

---

## üîí Role-Based Access Control (Detail)

```mermaid
flowchart TB
    subgraph LEVEL1["Level 1: Admin"]
        A1["Full System Access"]
        A2["User Management"]
        A3["All Sections Access"]
    end
    
    subgraph LEVEL2["Level 2: HC"]
        B1["Section Selection Required"]
        B2["All Workers View"]
        B3["Dashboard Full Access"]
    end
    
    subgraph LEVEL3["Level 3: Management"]
        C1["Direktur/VP/Manager"]
        C2["Section Selection Required"]
        C3["Read-Only Overview"]
    end
    
    subgraph LEVEL4["Level 4: Supervisory"]
        D1["Section Head/Sr Supervisor"]
        D2["Team Management"]
        D3["Filter by Unit"]
    end
    
    subgraph LEVEL5["Level 5: Coach"]
        E1["Coachee Management"]
        E2["Coaching Sessions"]
        E3["Personal Training View"]
    end
    
    subgraph LEVEL6["Level 6: Coachee"]
        F1["Personal Data Only"]
        F2["Training Records"]
        F3["Self Progress"]
    end
```

---

## üìä Struktur Database (Models)

```mermaid
erDiagram
    ApplicationUser {
        string Id PK
        string FullName
        string NIP
        string Position
        string Section
        string Unit
        string Directorate
        int RoleLevel
        DateTime JoinDate
    }
    
    TrainingRecord {
        int Id PK
        string Judul
        string Kategori
        DateTime Tanggal
        string Penyelenggara
        string Status
        string CertificateType
        DateTime ValidUntil
        string SertifikatUrl
    }
    
    CoachingLog {
        int Id PK
        string CoachId FK
        string CoacheeId FK
        DateTime Date
        string Topic
        string Feedback
    }
    
    AssessmentSession {
        int Id PK
        string Title
        string Category
        string Type
        DateTime Schedule
        int DurationMinutes
        string Status
        int Progress
        int Score
    }
    
    IdpItem {
        int Id PK
        string UserId FK
        string Title
        string Status
        DateTime DueDate
    }
    
    ApplicationUser ||--o{ TrainingRecord : has
    ApplicationUser ||--o{ CoachingLog : participates
    ApplicationUser ||--o{ AssessmentSession : takes
    ApplicationUser ||--o{ IdpItem : has
```

---

## üìÅ Struktur File Proyek

```
PortalHC_KPB/
‚îú‚îÄ‚îÄ Controllers/
‚îÇ   ‚îú‚îÄ‚îÄ AccountController.cs    ‚Üí Login, Logout, Profile, Settings
‚îÇ   ‚îú‚îÄ‚îÄ BPController.cs         ‚Üí TalentProfile, PointSystem, EligibilityValidator
‚îÇ   ‚îú‚îÄ‚îÄ CDPController.cs        ‚Üí IDP, Coaching, Progress, Dashboard
‚îÇ   ‚îú‚îÄ‚îÄ CMPController.cs        ‚Üí KKJ, Mapping, Assessment, Records
‚îÇ   ‚îî‚îÄ‚îÄ HomeController.cs       ‚Üí Home Page
‚îú‚îÄ‚îÄ Views/
‚îÇ   ‚îú‚îÄ‚îÄ Account/                ‚Üí Login.cshtml, Profile.cshtml, Settings.cshtml
‚îÇ   ‚îú‚îÄ‚îÄ BP/                     ‚Üí TalentProfile.cshtml, PointSystem.cshtml, etc.
‚îÇ   ‚îú‚îÄ‚îÄ CDP/                    ‚Üí Index.cshtml, Coaching.cshtml, Progress.cshtml
‚îÇ   ‚îú‚îÄ‚îÄ CMP/                    ‚Üí Kkj.cshtml, Assessment.cshtml, Records.cshtml
‚îÇ   ‚îú‚îÄ‚îÄ Home/                   ‚Üí Index.cshtml
‚îÇ   ‚îî‚îÄ‚îÄ Shared/                 ‚Üí _Layout.cshtml (Navigation)
‚îú‚îÄ‚îÄ Models/
‚îÇ   ‚îú‚îÄ‚îÄ ApplicationUser.cs      ‚Üí Extended Identity User
‚îÇ   ‚îú‚îÄ‚îÄ UserRoles.cs            ‚Üí Role Constants & Helpers
‚îÇ   ‚îú‚îÄ‚îÄ TrainingRecord.cs       ‚Üí Training Data Model
‚îÇ   ‚îú‚îÄ‚îÄ CoachingLog.cs          ‚Üí Coaching Data Model
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ Data/
‚îÇ   ‚îî‚îÄ‚îÄ ApplicationDbContext.cs ‚Üí EF Core DbContext
‚îî‚îÄ‚îÄ HcPortal.db                 ‚Üí SQLite Database
```

---

## üéØ Ringkasan Fitur Utama

| Modul | Fitur | Deskripsi |
|-------|-------|-----------|
| **CMP** | Susunan KKJ | Matrix kompetensi per jabatan |
| **CMP** | Assessment | Exam OJT, IHT, OTS, PROTON, HSSE |
| **CMP** | Capability Records | Tracking training per pekerja |
| **CMP** | KKJ-IDP Mapping | Mapping kompetensi ke silabus |
| **CDP** | Plan IDP | Silabus pengembangan kompetensi |
| **CDP** | Laporan Coaching | Log coaching Coach-Coachee |
| **CDP** | Progress & Tracking | Monitoring progress training |
| **CDP** | Dashboard | Visualisasi data keseluruhan |
| **BP** | Talent Profile | Profil & histori karir |
| **BP** | Point System | Sistem poin akselerasi karir |
| **BP** | Eligibility Validator | Validasi kelayakan promosi |
    </textarea>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', async function () {
            // 1. Initialize Mermaid with correct settings
            mermaid.initialize({
                startOnLoad: false,
                theme: 'default',
                securityLevel: 'loose',
                flowchart: {
                    useMaxWidth: true,
                    htmlLabels: true,
                    curve: 'basis'
                }
            });

            // 2. Get Markdown content
            const markdownText = document.getElementById('markdown-source').value;

            // 3. Configure Marked renderer
            const renderer = new marked.Renderer();

            // Counter for unique IDs
            let mermaidCounter = 0;

            // Override code block renderer to create unique IDs for each mermaid diagram
            renderer.code = function (code, language) {
                if (language === 'mermaid') {
                    const id = 'mermaid-' + (mermaidCounter++);
                    return '<pre class="mermaid" id="' + id + '">' + code + '</pre>';
                }
                return '<pre><code>' + code + '</code></pre>';
            };

            // 4. Render Markdown to HTML
            marked.setOptions({ renderer: renderer });
            document.getElementById('content').innerHTML = marked.parse(markdownText);

            // 5. Wait a bit for DOM to settle, then render all Mermaid diagrams
            setTimeout(async () => {
                try {
                    await mermaid.run({
                        querySelector: '.mermaid'
                    });
                } catch (error) {
                    console.error('Mermaid rendering error:', error);
                }
            }, 100);
        });
    </script>
</body>

</html>