@model HcPortal.Models.ApplicationUser

@{
    ViewData["Title"] = "Detail Pekerja";
    var role = ViewBag.Role as string ?? "No Role";
    var roleBadgeClass = role switch
    {
        "Admin" => "bg-danger",
        "HC" => "bg-warning text-dark",
        "Direktur" or "VP" or "Manager" => "bg-info text-dark",
        "Section Head" or "Sr Supervisor" => "bg-primary",
        "Coach" => "bg-success",
        _ => "bg-secondary"
    };
    var initials = Model.FullName.Length > 0
        ? string.Join("", Model.FullName.Split(' ').Take(2).Select(w => w[0].ToString().ToUpper()))
        : "?";
}

<div class="container py-4" style="max-width: 860px;">

    <!-- Breadcrumb -->
    <nav aria-label="breadcrumb" class="mb-3">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="@Url.Action("Index", "Admin")">Kelola Data</a></li>
            <li class="breadcrumb-item"><a href="@Url.Action("ManageWorkers", "Admin")">Manajemen Pekerja</a></li>
            <li class="breadcrumb-item active" aria-current="page">Detail Pekerja</li>
        </ol>
    </nav>

    <!-- Header -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <h2 class="fw-bold mb-1">
                <i class="bi bi-person-badge me-2 text-primary"></i>Detail Akun Pekerja
            </h2>
            <p class="text-muted mb-0">Informasi lengkap akun <strong>@Model.FullName</strong></p>
        </div>
        <div class="d-flex gap-2">
            <a href="@Url.Action("EditWorker", "Admin", new { id = Model.Id })" class="btn btn-primary" id="btnEditFromDetail">
                <i class="bi bi-pencil-square me-2"></i>Edit
            </a>
            <a href="@Url.Action("ManageWorkers", "Admin")" class="btn btn-outline-secondary">
                <i class="bi bi-arrow-left me-2"></i>Kembali
            </a>
        </div>
    </div>

    <!-- Card 1: Identity Banner -->
    <div class="card border-0 shadow-sm mb-4 overflow-hidden">
        <div class="card-body p-0">
            <div class="d-flex align-items-center p-4 gap-4" style="background: linear-gradient(135deg, #1e3a8a 0%, #2563eb 100%);">
                <div class="flex-shrink-0 rounded-circle bg-white text-primary fw-bold d-flex align-items-center justify-content-center shadow"
                     style="width: 80px; height: 80px; font-size: 1.8rem;">
                    @initials
                </div>
                <div class="text-white">
                    <h3 class="mb-1 fw-bold">@Model.FullName</h3>
                    <p class="mb-2 opacity-75"><i class="bi bi-envelope me-1"></i>@Model.Email</p>
                    <span class="badge @roleBadgeClass" style="font-size: 0.85rem;">@role</span>
                </div>
            </div>
        </div>
    </div>

    <div class="row g-4">

        <!-- Card 2: Informasi Organisasi -->
        <div class="col-md-6">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-header bg-success bg-opacity-10 border-0">
                    <h6 class="mb-0 fw-bold text-success">
                        <i class="bi bi-building me-2"></i>Informasi Organisasi
                    </h6>
                </div>
                <div class="card-body">
                    <table class="table table-borderless table-sm mb-0">
                        <tbody>
                            <tr>
                                <td class="text-muted pe-3" style="width: 45%;">NIP / Nopeg</td>
                                <td class="fw-semibold">@(Model.NIP ?? "-")</td>
                            </tr>
                            <tr>
                                <td class="text-muted">Jabatan</td>
                                <td class="fw-semibold">@(Model.Position ?? "-")</td>
                            </tr>
                            <tr>
                                <td class="text-muted">Bagian</td>
                                <td class="fw-semibold">
                                    @if (!string.IsNullOrEmpty(Model.Section))
                                    {
                                        <span class="badge bg-primary bg-opacity-10 text-primary">@Model.Section</span>
                                    }
                                    else
                                    {
                                        <span class="text-muted">-</span>
                                    }
                                </td>
                            </tr>
                            <tr>
                                <td class="text-muted">Unit</td>
                                <td class="fw-semibold"><small>@(Model.Unit ?? "-")</small></td>
                            </tr>
                            <tr>
                                <td class="text-muted">Directorate</td>
                                <td class="fw-semibold"><small>@(Model.Directorate ?? "-")</small></td>
                            </tr>
                            <tr>
                                <td class="text-muted">Tgl Bergabung</td>
                                <td class="fw-semibold">
                                    @(Model.JoinDate.HasValue ? Model.JoinDate.Value.ToString("dd MMMM yyyy") : "-")
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Card 3: Hak Akses & Sistem -->
        <div class="col-md-6">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-header bg-warning bg-opacity-10 border-0">
                    <h6 class="mb-0 fw-bold text-warning">
                        <i class="bi bi-shield-lock me-2"></i>Hak Akses &amp; Sistem
                    </h6>
                </div>
                <div class="card-body">
                    <table class="table table-borderless table-sm mb-0">
                        <tbody>
                            <tr>
                                <td class="text-muted pe-3" style="width: 50%;">Role</td>
                                <td><span class="badge @roleBadgeClass">@role</span></td>
                            </tr>
                            <tr>
                                <td class="text-muted">Role Level</td>
                                <td class="fw-semibold">Level @Model.RoleLevel</td>
                            </tr>
                            <tr>
                                <td class="text-muted">Email Terverifikasi</td>
                                <td>
                                    @if (Model.EmailConfirmed)
                                    {
                                        <span class="text-success"><i class="bi bi-check-circle-fill me-1"></i>Ya</span>
                                    }
                                    else
                                    {
                                        <span class="text-danger"><i class="bi bi-x-circle-fill me-1"></i>Belum</span>
                                    }
                                </td>
                            </tr>
                            <tr>
                                <td class="text-muted">Akun Terkunci</td>
                                <td>
                                    @if (Model.LockoutEnd.HasValue && Model.LockoutEnd.Value > DateTimeOffset.UtcNow)
                                    {
                                        <span class="text-danger"><i class="bi bi-lock-fill me-1"></i>Terkunci</span>
                                    }
                                    else
                                    {
                                        <span class="text-success"><i class="bi bi-unlock-fill me-1"></i>Aktif</span>
                                    }
                                </td>
                            </tr>
                            <tr>
                                <td class="text-muted">Username</td>
                                <td><small class="font-monospace text-muted">@Model.UserName</small></td>
                            </tr>
                            <tr>
                                <td class="text-muted">User ID</td>
                                <td><small class="font-monospace text-muted" style="font-size: 0.68rem;">@Model.Id</small></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

    </div>

    <!-- Bottom Actions -->
    <div class="d-flex justify-content-end gap-2 mt-4">
        <a href="@Url.Action("ManageWorkers", "Admin")" class="btn btn-light px-4">
            <i class="bi bi-arrow-left me-2"></i>Kembali ke Daftar
        </a>
        <a href="@Url.Action("EditWorker", "Admin", new { id = Model.Id })" class="btn btn-primary px-4">
            <i class="bi bi-pencil-square me-2"></i>Edit Akun
        </a>
    </div>
</div>
